
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorateur de Fonctions ML</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <h1>Explorateur de Fonctions Machine Learning</h1>
        <p>Visualisez les fonctions d'activation et leurs gradients, ou créez les vôtres.</p>
    </header>

    <main>
        <section class="card">
            <h2>Fonctions d'Activation Prédéfinies</h2>
            <form id="function-form">
                <div class="form-group">
                    <label for="function-select">Choisissez une fonction :</label>
                    <select id="function-select" name="function_name">
                        {% for name in function_names %}
                            <option value="{{ name }}">{{ name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label>Type de graphique :</label>
                    <input type="radio" id="plot-type-2d" name="plot_type" value="2d" checked>
                    <label for="plot-type-2d">2D (Fonction & Dérivée)</label>
                    <input type="radio" id="plot-type-3d" name="plot_type" value="3d">
                    <label for="plot-type-3d">3D (Surface)</label>
                </div>
                <button type="submit">Générer le graphique</button>
            </form>
            <div class="plot-container">
                <img id="plot-predefined" alt="Graphique de la fonction sélectionnée.">
                <span class="loading-message">Génération du graphique...</span>
            </div>
        </section>

        <section class="card">
            <h2>Créateur de Fonction Personnalisée</h2>
            <p>Définissez votre propre fonction en utilisant Python et NumPy (ex: <code>np.sin(x) * y</code>).</p>
            <form id="custom-function-form">
                <div class="form-group">
                    <label for="custom-function-input">Fonction f(x, y) =</label>
                    <input type="text" id="custom-function-input" name="custom_function" placeholder="np.exp(-0.1*(x**2 + y**2))">
                </div>
                 <div class="form-group">
                    <label>Type de graphique :</label>
                    <input type="radio" id="custom-plot-type-2d" name="plot_type" value="2d" checked>
                    <label for="custom-plot-type-2d">2D</label>
                    <input type="radio" id="custom-plot-type-3d" name="plot_type" value="3d">
                    <label for="custom-plot-type-3d">3D</label>
                </div>
                <button type="submit">Tracer la fonction</button>
            </form>
            <div class="plot-container">
                <img id="plot-custom" alt="Graphique de la fonction personnalisée.">
                <span class="loading-message">Génération du graphique...</span>
            </div>
        </section>
    </main>

    <script>
        document.getElementById('function-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const functionName = formData.get('function_name');
            const plotType = formData.get('plot_type');
            
            const img = document.getElementById('plot-predefined');
            const loading = img.nextElementSibling;

            img.style.display = 'none';
            loading.style.display = 'block';

            img.onload = () => {
                img.style.display = 'block';
                loading.style.display = 'none';
            };
            img.src = `/plot/predefined?function_name=${functionName}&plot_type=${plotType}&t=${new Date().getTime()}`;
        });

        document.getElementById('custom-function-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const customFunction = encodeURIComponent(formData.get('custom_function'));
            const plotType = formData.get('plot_type');

            if (!customFunction) {
                alert("Veuillez entrer une fonction.");
                return;
            }

            const img = document.getElementById('plot-custom');
            const loading = img.nextElementSibling;

            img.style.display = 'none';
            loading.style.display = 'block';

            img.onload = () => {
                img.style.display = 'block';
                loading.style.display = 'none';
            };
            img.src = `/plot/custom?custom_function=${customFunction}&plot_type=${plotType}&t=${new Date().getTime()}`;
        });
    </script>
</body>
</html>
